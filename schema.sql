Show Databases;
use Housify;

CREATE TABLE IF NOT EXISTS USER (
    USER_ID VARCHAR(50) NOT NULL PRIMARY KEY,
    NAME VARCHAR(20) NOT NULL, 
    EMAIL VARCHAR(20) NOT NULL UNIQUE, 
    PASSWORD VARCHAR(15) NOT NULL, 
    PHONE VARCHAR(15),
    INCOME DECIMAL(10 , 2)
);

CREATE TABLE IF NOT EXISTS LISTING (
    IMAGE_URL TEXT,
    ID VARCHAR(50)  PRIMARY KEY ,
    USER_ID VARCHAR(50) NOT NULL ,
    NAME VARCHAR(50) , 
    DESCRIPTION TEXT(200) NOT NULL,
    STREET VARCHAR(40),
    CITY VARCHAR(40) NOT NULL,
    STATE VARCHAR(40) NOT NULL,
    PINCODE INT(6) NOT NULL,
    AVAILABILITY BOOLEAN DEFAULT TRUE , 
    PRICEPERMONTH DECIMAL(10 ,2) NOT NULL,
    DISCOUNT DECIMAL(4 , 2),
    SIZE INT NOT NULL , 
    RATING INT
);

CREATE TABLE IF NOT EXISTS BOOKING (
    ID VARCHAR(40) NOT NULL PRIMARY KEY , 
    USER_ID VARCHAR(50) NOT NULL,
    LISTING_ID VARCHAR(50) NOT NULL, 
    START_DATE DATE , 
    END_DATE DATE
);

ALTER TABLE LISTING
ADD FOREIGN KEY (USER_ID) REFERENCES USER(USER_ID) ON DELETE CASCADE;

ALTER TABLE BOOKING 
ADD FOREIGN KEY (USER_ID) REFERENCES USER(USER_ID), 
ADD FOREIGN KEY (LISTING_ID) REFERENCES LISTING(ID) ON DELETE CASCADE;